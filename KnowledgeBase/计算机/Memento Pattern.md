---
tags: 
alias:
---
  
备忘录模式（Memento Pattern）是一种行为设计模式，它允许在不暴露[[对象]]内部状态和实现细节的情况下，捕获和外部化一个对象的内部状态，以便在之后将该对象恢复到此状态。这种模式在需要提供撤销功能的场景中非常有用，比如文本编辑器的撤销操作，或是游戏中的回退功能。

### 主要组成部分

备忘录模式主要包含三个角色：

1. **发起人（Originator）**：
    
    - 负责创建一个备忘录，用以记录当前时刻它的内部状态。
    - 也负责使用备忘录来恢复其内部状态。
    - 在实现时，发起人通常提供一个方法来保存其状态，以及另一个方法来恢复状态。
2. **备忘录（Memento）**：
    
    - 负责存储发起人的内部状态，并且可以防止发起人以外的其他对象访问备忘录。
    - 备忘录有两个接口，管理者接口提供给负责人以供备忘录的保存和恢复，而窄接口则对其他对象隐藏了可以恢复的状态。
3. **负责人（Caretaker）**：
    
    - 负责保存备忘录。
    - 不检查备忘录的内容。
    - 它存储备忘录对象，但不修改对象，也不直接访问其内容。

### 如何工作

- 当需要保存某个对象的状态时，该对象会创建一个包含其当前状态的备忘录对象，并将此对象传递给负责人。负责人随后可以根据需要保存这些备忘录，而无需了解其内容。
- 当需要撤销到某个状态或进行回滚时，负责人会将对应的备忘录对象返回给发起人。发起人随后使用备忘录对象来恢复其内部状态。