---
tags: 
aliases:
  - Daemon Process
---

一种在后台运行的特殊类型的进程，它独立于控制终端，并且周期性地执行某种任务或等待处理某些发生的事件。守护进程通常在系统启动时启动，持续运行直到系统关闭。它们不与前台用户界面交互，而是在后台默默地执行服务任务。

### 守护进程的主要特点：

1. **后台运行**：守护进程在后台运行，不会占用任何终端或用户界面。
    
2. **长期运行**：守护进程通常在系统启动时启动，一直运行到系统关闭。
    
3. **独立于用户**：守护进程独立于用户会话运行，不会因为用户注销而终止。
    
4. **执行周期性任务**：守护进程可以周期性地执行任务，如日志轮转、系统监控等。
    
5. **事件响应**：守护进程可能在等待某些事件的发生，如网络请求、系统事件等，并对其做出响应。
    

### 守护进程的应用：

守护进程在计算机系统中承担着许多关键的服务和任务，例如：

- **Web服务器**：如Apache、Nginx，这些守护进程在后台监听HTTP请求并提供Web内容。
- **数据库服务**：如MySQL、PostgreSQL，这些守护进程管理数据库的存储、查询、更新等。
- **邮件服务**：如Sendmail、Postfix，这些守护进程处理电子邮件的发送和接收。
- **系统监控**：如Nagios、Zabbix，这些守护进程监控系统的健康和性能。
- **日志服务**：如Syslog，这个守护进程收集和管理系统日志。
- **定时任务**：如Cron，这个守护进程根据预定的计划执行指定的任务。

### 创建守护进程：

在Unix-like系统中，创建守护进程通常涉及以下步骤：

1. **创建子进程**：父进程创建一个子进程并退出，这使得子进程成为孤儿进程并被init进程（PID为1的进程）收养。
    
2. **改变工作目录**：通常将工作目录改变到根目录，以避免守护进程持有任何目录，这可能会阻止文件系统的卸载。
    
3. **重设文件掩码**：调用`umask()`设置进程的文件模式创建掩码，通常设置为0以避免继承并影响守护进程创建的文件权限。
    
4. **关闭文件描述符**：关闭所有从父进程继承的文件描述符，因为守护进程不应与任何终端或文件交互。
    
5. **开启新会话**：调用`setsid()`创建一个新的会话，并让守护进程成为会话的领头进程和进程组的领头进程。这样做的目的是让守护进程脱离任何终端控制。
    

守护进程是许多计算机系统和服务器正常运行不可或缺的部分，它们为系统提供了许多基础和关键的服务。
