---
tags: 
alias:
- Coroutine
---


# 介绍
协程是轻量级的[[Threads|线程]]，它的轻量级体现在启动和切换：协程的启动不需要申请额外的堆栈空间；协程的切换发生在用户态，而非内核态。
它**基于[[线程池]]API**。

## 原理
### 续体传递
续体传递风格(Continuation-Passing-Style)，本质上是代码的回调与结果的传递。
### 状态机
协程的代码在经过编译器处理时会被优化为状态机模型，每段代码有三个状态：未执行、挂起、已恢复。
## 核心概念
### 协程作用域
协程的作用域有三种，他们分别是：

- `runBlocking`：顶层函数，它和 `coroutineScope` 不一样，它会阻塞当前线程来等待，所以这个方法在业务中并不适用 。
- `GlobalScope`：全局协程作用域，可以在整个应用的声明周期中操作，且不能取消，所以仍不适用于业务开发。
- 自定义作用域：自定义协程的作用域，不会造成内存泄漏。

显然，我们不能在 `Activity` 中调用 `GlobalScope`




