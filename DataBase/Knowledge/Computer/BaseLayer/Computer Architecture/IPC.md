---
alias:
- Inter-process communication
- 进程间通信
tags:
- computerArchitecture 
---
# 概念
在[[DataBase/Knowledge/Computer/BaseLayer/Operating Systems/Operating System|操作系统]]中，每个[[Processes|进程]]都有一块独立的内存空间。为了保证程序安全，一般会有一套严格的安全机制来禁止进程间的非法访问。
但是进程间也存在相互通信的需要，这时候就需要引入[[IPC]]的概念。
# 原理
内核程序在内核空间分配内存并开辟一块内核缓存区，发送进程通过copy_from_user函数将数据拷贝到到内核空间的缓冲区中。同样的，接收进程在接收数据时在自己的用户空间开辟一块内存缓存区，然后内核程序调用 copy_to_user() 函数将数据从内核缓存区拷贝到接收进程。这样数据发送进程和数据接收进程完成了一次数据传输，也就是一次进程间通信。

# 举例
常见的进程间通信方式有共享内存、管道、UDS以及[[Binder]]等。
| **通信方式**             | **适用场景** | **优缺点**                                                                                                                       | **原理**                                                                                                                                                                                                                                                                   |
| ------------------------ | ------------ | -------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 共享内存（Shared Memory) |              |                                                                                                                                  | 共享内存方式实现进程间通信依靠的是申请一块内存区域，让后将这块内存映射到进程空间中，这样两个进程都可以直接访问这块内存。在进行进程间通信时，两个进程可以利用这块内存空间进行数据交换。通过这样的方式，减少了数据的赋值操作，因此共享内存实现进程间通信在速度上有明显优势。 |
| 管道（Pipe）             |              | 在创建时分配一个page大小的内存，缓存区大小比较有限；                                                                             | 管道也是操作系统中常见的一种进程间通信方式，Windows系统进程间的通信依赖于此中方式实现。在进行进程间通信时，会在两个进程间建立一根拥有读（read）写(write)功能的管道,一个进程写数据，另一个进程可以读取数据，从而实现进程间通信问题。                                        |
| 套接字                   |              | 作为更通用的接口，传输效率低，主要用于不通机器或跨网络的通信；                                                                   |                                                                                                                                                                                                                                                                            |
| 消息队列                 |              | 信息复制两次，额外的CPU消耗；不合适频繁或信息量大的通信；                                                                        |                                                                                                                                                                                                                                                                            |
| 信号量                   |              | 常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。 |                                                                                                                                                                                                                                                                            |
| 信号                     |              | 不适用于信息交换，更适用于进程中断控制，比如非法内存访问，杀死某个进程等；                                                                                                                                 |                                                                                                                                                                                                                                                                            |

-   **共享内存（Shared Memory)** 共享内存方式实现进程间通信依靠的是申请一块内存区域，让后将这块内存映射到进程空间中，这样两个进程都可以直接访问这块内存。在进行进程间通信时，两个进程可以利用这块内存空间进行数据交换。通过这样的方式，减少了数据的赋值操作，因此共享内存实现进程间通信在速度上有明显优势。
    
-   **管道（Pipe）** 管道也是操作系统中常见的一种进程间通信方式，Windows系统进程间的通信依赖于此中方式实现。在进行进程间通信时，会在两个进程间建立一根拥有读（read）写(write)功能的管道,一个进程写数据，另一个进程可以读取数据，从而实现进程间通信问题。
    
-   **UDS（UNIX Domain Socket）** UDS也被称为IPC Socket，但它有别于network 的Socket。UDS的内部实现不依赖于TCP/IP协议，而是基于本机的“安全可靠操作”实现。UDS这种进程间通信方式在Android中用到的也是比较多的。
    
-   **Binder** [[Binder]]是Android中独有的一种进程间通信方式。它底层依靠mmap,只需要一次数据拷贝，把一块物理内存同时映射到内核和目标进程的用户空间。
- **信号** 信号是软件层次上对中断机制的一种模拟，是一种异步通信方式，进程不必通过任何操作来等待信号的到达。信号可以在用户空间进程和内核之间直接交互，内核可以利用信号来通知用户空间的进程发生了哪些系统事件。信号不适用于信息交换，比较适用于进程中断控制。
无论哪种进程间通信，都是一个进程（服务端）提供数据，一个进程（客户端）获取数据，通信方法类似一种数据传输协议。

# References 
